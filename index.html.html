<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªÛ•Ø³Ø¨ÛŒØ­Ø§ Ù†Û†Ø±Ø§ Ø¯Ù„Ø§Ù†</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Reem+Kufi:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00E676; 
            --bg-color: #051a15;
            --glow: rgba(0, 230, 118, 0.4);
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; height: 100vh;
            background: radial-gradient(circle at center, #0f2e26, var(--bg-color));
            font-family: 'Amiri', serif;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            color: white; overflow: hidden;
        }

        .app-name {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 22px;
            color: var(--primary);
            margin-bottom: 30px;
            text-shadow: 0 0 10px var(--glow);
            border-bottom: 1px solid rgba(0, 230, 118, 0.2);
            padding-bottom: 5px;
        }

        .zikr-container { text-align: center; margin-bottom: 20px; height: 130px; }
        .zikr-arabic {
            font-size: 42px; color: var(--primary);
            text-shadow: 0 0 20px var(--glow); margin: 0; line-height: 1.3;
        }
        .zikr-badini { font-size: 18px; color: #aaa; font-family: 'Reem Kufi', sans-serif; }

        .ring-wrapper {
            position: relative; width: 300px; height: 300px;
            display: flex; justify-content: center; align-items: center;
        }

        svg { position: absolute; width: 100%; height: 100%; transform: rotate(-90deg); }
        circle { fill: none; stroke-width: 12; stroke-linecap: round; }
        .bg-ring { stroke: rgba(255, 255, 255, 0.05); }
        .progress-ring {
            stroke: var(--primary); stroke-dasharray: 880; stroke-dashoffset: 880;
            transition: stroke-dashoffset 0.15s ease;
            filter: drop-shadow(0 0 8px var(--primary));
        }

        .main-btn {
            width: 230px; height: 230px; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #1a4d45, #00221c);
            border: 4px solid rgba(0, 230, 118, 0.2);
            box-shadow: 0 10px 40px rgba(0,0,0,0.5), inset 0 0 40px rgba(0,0,0,0.8);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; z-index: 10; transition: 0.1s;
        }

        .main-btn:active { transform: scale(0.94); border-color: var(--primary); }

        #count { font-size: 90px; font-weight: bold; font-family: 'Reem Kufi', sans-serif; line-height: 1; }
        .total-text { font-size: 15px; color: #888; margin-top: 5px; }

        .controls { margin-top: 40px; display: flex; gap: 20px; }
        .action-btn {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            color: #ccc; width: 60px; height: 60px; border-radius: 50%;
            font-size: 18px; cursor: pointer; display: flex; justify-content: center; align-items: center;
        }

        .btn-audio {
            width: auto; padding: 0 25px; border-radius: 30px;
            background: var(--primary); color: #000; font-weight: bold; gap: 8px;
        }
    </style>
</head>
<body>

    <div class="app-name">ØªÛ•Ø³Ø¨ÛŒØ­Ø§ Ù†Û†Ø±Ø§ Ø¯Ù„Ø§Ù†</div>

    <div class="zikr-container">
        <h1 class="zikr-arabic" id="arabicText">Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù</h1>
        <span class="zikr-badini" id="badiniText">Ù¾Ø§Ù‚Ú˜ Ùˆ Ø¨ÛÚ¯Û•Ø±Ø¯ÛŒ Ø¨Û† Ø®ÙˆØ¯Ø§ÛŒÛ Ù…Û•Ø²Ù†Û•</span>
    </div>

    <div class="ring-wrapper">
        <svg viewBox="0 0 300 300">
            <circle class="bg-ring" cx="150" cy="150" r="140"></circle>
            <circle class="progress-ring" id="ring" cx="150" cy="150" r="140"></circle>
        </svg>

        <div class="main-btn" onclick="ziadKe()">
            <span id="count">0</span>
            <span class="total-text">Ú©Û†Ù…Ø§ Ú¯Ø´ØªÙ‰: <span id="totalDisplay">0</span></span>
        </div>
    </div>

    <div class="controls">
        <button class="action-btn" onclick="kemKe()">â†©ï¸</button>
        <button class="action-btn btn-audio" onclick="playCurrentZikr()">
            ğŸ”Š Ø¨Ø®ÙˆÛŒÙ†Û•
        </button>
        <button class="action-btn" onclick="sifirKe()" style="color:#ff5252">â†º</button>
    </div>

    <script>
        // Ø¯Û•Ù†Ú¯Û ØªÙˆÙˆØª Ø¨Û Ø¦ÛŒÙ†ØªÛ•Ø±Ù†ÛØª
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTootSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.type = 'sine'; 
            oscillator.frequency.setValueAtTime(650, audioCtx.currentTime); 
            gainNode.gain.setValueAtTime(0.08, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.1);
        }

        let total = localStorage.getItem("nora_dilan_tasbih") ? parseInt(localStorage.getItem("nora_dilan_tasbih")) : 0;
        
        // Ù„ÛØ±Û• Ø­Ø±Ú©Ø§ØªÛÙ† (Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù) Ù‡Ø§ØªÙ†Û• Ú•Ø§Ø³ØªÚ©Ø±Ù† Ø¨Û† Ø®ÙˆÙˆÙ†Ø¯Ù†Û•Ú©Ø§ Ø¯Ø±ÙˆØ³Øª
        const zikrs = [
            { ar: "Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù", ku: "Ù¾Ø§Ù‚Ú˜ Ùˆ Ø¨ÛÚ¯Û•Ø±Ø¯ÛŒ Ø¨Û† Ø®ÙˆØ¯Ø§ÛŒÛ Ù…Û•Ø²Ù†Û•", max: 33 },
            { ar: "Ù±Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù°Ù‡Ù", ku: "Ø³ÙˆÙ¾Ø§Ø³ Ùˆ Ø³ØªØ§ÛŒÛŒØ´ Ø¨Û† Ø®ÙˆØ¯Ø§ÛŒÛ Ø¯Ù„ÙˆÚ¤Ø§Ù†", max: 33 },
            { ar: "Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù", ku: "Ø®ÙˆØ¯Û Ù…Û•Ø²Ù†ØªØ±ÛŒÙ†Û•", max: 33 },
            { ar: "Ù„ÙØ§ Ø¥ÙÙ„ÙÙ°Ù‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù ÙˆÙØ­Ù’Ø¯ÙÙ‡Ù Ù„ÙØ§ Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙ‡ÙØŒ Ù„ÙÙ‡Ù Ù±Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ„ÙÙ‡Ù Ù±Ù„Ù’Ø­ÙÙ…Ù’Ø¯ÙØŒ ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰Ù° ÙƒÙÙ„ÙÙ‘ Ø´ÙÙ‰Ù’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒ", ku: "Ú† Ø®ÙˆØ¯Ø§ÙˆÛ•Ù†Ø¯ Ù†ÛŒÙ†Ù† Ú˜Ø¨Ù„ÛŒ Ø§Ù„Ù„Û•", max: 1 }
        ];

        const cycleTotal = 100;
        const circumference = 2 * Math.PI * 140; 
        const ring = document.getElementById("ring");
        const synth = window.speechSynthesis;

        updateUI();

        function ziadKe() {
            total++;
            playTootSound();
            if(navigator.vibrate) navigator.vibrate(25);
            checkTransition();
            saveData();
            updateUI();
        }

        function kemKe() {
            if(total > 0) { total--; playTootSound(); saveData(); updateUI(); }
        }

        function sifirKe() {
            if (confirm("Ø¦Û•Ø±Û ØªÙˆ Ù¾Ø´Øª Ø±Ø§Ø³ØªÛŒ ØªÛ• Ø¯Ú¤ÛØª Ù‡Û•Ù…ÛŒÛ Ø³ÙØ± Ø¨Ú©Û•ÛŒØŸ")) {
                total = 0; saveData(); updateUI();
            }
        }

        function getCurrentState() {
            let currentInCycle = total % cycleTotal;
            if (currentInCycle === 0 && total > 0) currentInCycle = 100;
            if (currentInCycle <= 33) return { obj: zikrs[0], current: currentInCycle, p: currentInCycle/33 };
            if (currentInCycle <= 66) return { obj: zikrs[1], current: currentInCycle - 33, p: (currentInCycle-33)/33 };
            if (currentInCycle <= 99) return { obj: zikrs[2], current: currentInCycle - 66, p: (currentInCycle-66)/33 };
            return { obj: zikrs[3], current: 1, p: 1 };
        }

        function updateUI() {
            const state = getCurrentState();
            document.getElementById("count").innerText = (total === 0) ? 0 : state.current;
            document.getElementById("totalDisplay").innerText = total;
            document.getElementById("arabicText").innerText = state.obj.ar;
            document.getElementById("badiniText").innerText = state.obj.ku;
            let offset = circumference - (state.p * circumference);
            ring.style.strokeDashoffset = (total === 0) ? circumference : offset;
        }

        function playCurrentZikr() {
            const state = getCurrentState();
            if (synth.speaking) synth.cancel();
            const utter = new SpeechSynthesisUtterance(state.obj.ar);
            utter.lang = 'ar-SA'; // Ø²Ù…Ø§Ù†Û Ø¹Û•Ø±Û•Ø¨ÛŒÛ Ø³Ø¹ÙˆØ¯Ù‰ Ø¨Û† Ø¨Ø§Ø´ØªØ±ÛŒÙ† Ø®ÙˆÙˆÙ†Ø¯Ù†
            utter.rate = 0.85; 
            utter.pitch = 0.8; 
            synth.speak(utter);
        }

        function checkTransition() {
            let currentInCycle = total % cycleTotal;
            if (currentInCycle === 33 || currentInCycle === 66 || currentInCycle === 99 || currentInCycle === 0) {
                if(navigator.vibrate) navigator.vibrate([100, 50, 100]);
                setTimeout(playCurrentZikr, 400);
            }
        }

        function saveData() { localStorage.setItem("nora_dilan_tasbih", total); }
    </script>
</body>
</html>